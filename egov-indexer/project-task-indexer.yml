ServiceMaps:
  serviceName: Project Service
  version: 1.0.0
  mappings:
    - topic: save-project-task-topic
      configKey: INDEX
      indexes:
        - name: project-task-index-v1
          type: tasks
          id: $.id
          isBulk: true
          jsonPath: $
          customJsonMapping:
            indexMapping: { "Data": { "projectTask": {}, "delivered": {} } }
            fieldMapping:
              - inJsonPath: $.projectId
                outJsonPath: $.Data.projectTask.projectId
              - inJsonPath: $.auditDetails.createdBy
                outJsonPath: $.Data.projectTask.userId
              - inJsonPath: $.resources[?(@.isDelivered == true)].productVariantId
                outJsonPath: $.Data.delivered.productVariantId
          timeStampField: $.auditDetails.createdTime

    - topic: update-project-task-topic
      configKey: INDEX
      indexes:
        - name: projectTaskUpdateIndex-v1
          type: projectTaskUpdate
          id: $.id
          isBulk: true
          jsonPath: $.*
          timeStampField: $.auditDetails.lastModifiedTime

    - topic: delete-project-task-topic
      configKey: INDEX
      indexes:
        - name: projectTaskDeleteIndex-v1
          type: projectTaskDelete
          id: $.id
          isBulk: true
          jsonPath: $.*
          timeStampField: $.auditDetails.lastModifiedTime